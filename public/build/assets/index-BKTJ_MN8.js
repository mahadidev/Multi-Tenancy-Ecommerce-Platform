import{j as t,B as g,R as S,a as c,O as x,r as d,c as j}from"./chunk-K6AXKMTT-BnIgBbzJ.js";import{f as y,G as f,c as R,a as A,p as w,b as E,d as P,e as L,u as T,g as b,s as F,P as _}from"./index-D2T1X0LL.js";import{T as B}from"./getComponent-DtBbzTy-.js";const q=y({baseUrl:f,prepareHeaders:e=>(e.set("accept","application/json"),e)}),k=({url:e,method:r="GET",body:s,apiMethod:o})=>o?{url:e,method:r,body:{...s,_method:o}}:{url:e,method:r,body:s},G={store:null},l=R({name:"store",initialState:G,reducers:{setStore:(e,r)=>{e.store=r.payload},clearStore:e=>{e.store=null}}}),{setStore:I,clearStore:K}=l.actions,Q=l.reducer,a=A({reducerPath:"storeApi",baseQuery:q,tagTypes:["Store"],endpoints:e=>({fetchStore:e.query({query:r=>k({url:`/store?domain=${r.slug}`,method:"get"}),providesTags:["Store"],transformErrorResponse:r=>r.data,async onQueryStarted(r,{dispatch:s,queryFulfilled:o}){await o.then(n=>{s(I(n.data.data.store))})}})})}),{useFetchStoreQuery:$}=a,v={key:"site",blacklist:["storeApi"],storage:F,version:0},C=w(v,E({store:Q,[a.reducerPath]:a.reducer})),m=P({reducer:C,middleware:e=>e({serializableCheck:!1}).concat([a.middleware])});L(m);T.withTypes();const O=b.withTypes(),U=window.document;var u;const p=(u=U.head.querySelector('meta[name="site-slug"]'))==null?void 0:u.content,h=()=>{const{isLoading:e}=$({slug:p}),{store:r}=O(s=>s.store);return{fetchStore:{isLoading:e},store:r}},z=function(e){const{store:r}=h();return t.jsx(t.Fragment,{children:e.widgets.slice().sort(function(s,o){return s.serial-o.serial}).map(s=>t.jsx(t.Fragment,{children:r&&r.theme&&t.jsx(B,{store:r,widget:s,theme:r.theme})}))})},D=function(){var s,o;const{store:e,fetchStore:r}=h();return t.jsx(t.Fragment,{children:t.jsx(g,{basename:`/sites/${p}`,children:e?t.jsx(t.Fragment,{children:t.jsx(S,{children:((s=e.pages)==null?void 0:s.length)>0?(o=e==null?void 0:e.pages)==null?void 0:o.map((n,i)=>t.jsx(c,{path:"/",element:t.jsx(x,{}),children:t.jsx(c,{path:n.type.type==="home"?"/":n.slug,index:!0,element:d.createElement(z,{...n,key:i})},i)})):t.jsx(c,{index:!0,element:t.jsx("h1",{children:"No page created."})})})}):t.jsx(t.Fragment,{children:r.isLoading&&"loading.."})})})};document.getElementById("root")&&j.createRoot(document.getElementById("root")).render(t.jsx(_,{store:m,children:t.jsx(d.StrictMode,{children:t.jsx(D,{})})}));
